<template name="viewExamplePlaces">
  <h4>View Example Places</h4>
  {{#if Template.subscriptionsReady}}
  <form id="viewExamplePlaces">
    {{> selectPlaceDropdown}}
    <div class="input-group">
      <input name="search" id="cityname" type="text" class="form-control" placeholder="Type a city name..."
        required="true">
      <span class="input-group-btn">
        <button class="btn btn-default" type="submit">
          <span class="glyphicon glyphicon-search"></span> Example Places
        </button>
      </span>
    </div>
    {{#if placeTagToAnalyze}}
    <div>{{lengthOfViewExamplePlaces}} results found</div>
    {{/if}}
  </form>
  <ul class="list-group view-example-places-list">
    {{#each situation in exampleSituations}}
    <li class="list-group-item">
      {{> situationItem (situationArgs situation)}}
    </li>
    {{/each}}
  </ul>
  {{/if}}
</template>

<template name="selectPlaceDropdown">
  <div class="form-group">
    <select name="selectPlaceKey" class="form-control" id="selectPlaceToAnalyze" form="viewExamplePlaces"
      required="true">
      <option default value="">Select a place tag...</option>
      {{#each placetag in placeTagList}}
      <option value="{{placetag}}">{{placetag}}</option>
      {{/each}}
    </select>
  </div>
</template>

<template name="simulateAndLabelConceptExpression">
  <h4>Assess Accuracy of Concept Variables</h4>
  {{#if Template.subscriptionsReady}}
  <form id="simulateConcepts">
    {{> selectConceptVariableDropdown}}
    <div class="input-group citystuff">
      <input name="search_sim" id="cityname_sim" type="text" class="form-control" placeholder="Type a city name..."
        required="true">
        
      <span class="input-group-btn">
        
        <button id = "simulate" class="btn btn-warning" type="submit">
          Simulate
        </button>
      </span>
    </div>
    {{#if hasConcept}}
    <h5><em>Do these places accurately represent "{{conceptVariableHumanReadable}}", thus good for
        "{{highLevelSituation}}"?</em></h5>
    {{/if}}
    <div id="length-sim-concept-list">{{lengthSimConceptList}} results found</div>
  </form>
  <form id= "simulateConceptsAgain">
    <span class="input-group-btn">
      <button  class="btn btn-warning" type="submit">
        Simulate Again
      </button>
    </span>
  </form>
  <ul class="list-group simulate-concept-expression-list">
    {{#each situation in detectedSituations}}
    <li class="list-group-item">
      {{> situationAnnotateItem (situationArgs situation)}}
    </li>
    {{/each}}
  </ul>
  {{/if}}
</template>

<template name="selectConceptVariableDropdown">
  <div class="form-group">
    <select name="selectConceptVariableKey" class="form-control" id="selectConceptVariableToAnalyze"
      form="conceptSimulate" required="true">
      <option default value="">Select a concept variable...</option>
      {{#each concept in conceptVariableList }}
      <option value="{{concept.features}}">{{concept.name}}</option>
      {{/each}}
    </select>
  </div>
</template>

<template name="repairShop">
  <h4>Repair Shop</h4>
  {{> exampleSituationIssues}}
</template>

<template name="exampleSituationIssues">
  <h5><em>Issue List</em></h5>
  {{#if Template.subscriptionsReady}}
  <ul class="list-group concept-issues-list">
    {{#each situation in falsePositives}}
    <li class="list-group-item false-positive">
      {{> situationIssueItem (situationArgs situation)}}
    </li>
    {{/each}}
  </ul>
  <ul class="list-group concept-issues-list">
    {{> instructions}}
  </ul>
  <ul class="list-group concept-issues-list">
   
    
    {{#each situation in falsePositives }}
    {{#if (hasSingleCategory situation)}}
    {{> promptForReflection situation = situation categories = situation.categories}}
    {{else}}
    {{> surfaceConfoundingContextFeatures situation = situation categories = situation.categories}}
    {{/if}}
    {{/each}}
    {{#each situation in truePositives }}
    {{> suggestContextFeatures situation = situation categories = situation.categories}}
    {{/each}}
    
  </ul>

  
  <h5><em>Resolved Cases</em></h5>
  {{#if Template.subscriptionsReady}}
  <ul class="list-group concept-issues-list">
    {{#each situation in trueNegatives}}
    <li class="list-group-item true-negative">
      {{> situationIssueItem (situationArgs situation)}}
    </li>
    {{/each}}
  </ul>
  {{/if}}
  {{/if}}
 
</template>

<template name="situationItemImageNameCats">
  <div style="display: table-cell; padding-right: 5px;">
    <div class="place-photo-item">
      <img src={{situation.image_url}} width="90" height="90"
        style="object-fit: cover; border-radius: 4px; vertical-align: middle;" />
    </div>
  </div>
  <div style="display: table-cell;">
    <div class="place-name" style="width: 50ch">
      <h3 style="font-size: 16px; font-weight: 700;">
        <p><a href="{{situation.url}}" target="_blank">{{situation.name}}</a></p>
      </h3>
    </div>
    <div class="place-categories">
      {{#each category in (situationCategoriesAlias situation)}}
      {{#if baseline}}
      <span><a href="#">
          {{category}},
        </a></span>
      {{else}}
      <span><a class="context-feature-link" alias="{{category}}" href="#">
          {{category}},
        </a></span>
      {{/if}}
      {{/each}}
    </div>
  </div>
</template>

<template name="situationItem">
  <div style="display: table; table-layout: auto;">
    {{> situationItemImageNameCats situation=situation}}
  </div>
</template>

<template name="situationAnnotateItem">
  <div style="display: table; table-layout: auto;">
    {{> situationItemImageNameCats situation=situation}}
    <div style="display: table-cell; vertical-align: top; padding-top: 0;">
      {{> situationItemLabelEdit situation=situation}}
    </div>
  </div>
</template>

<template name="situationIssueItem">
  <div style="display: table; table-layout: auto;">
    {{> situationItemImageNameCats situation=situation}}
    <div style="display: table-cell; vertical-align: top; padding-top: 0;">
      {{> situationItemLabelView situation=situation}}
    </div>
    <div style="display: table-cell; vertical-align: top; padding-top: 0;">
      {{> situationItemPrediction situation=situation}}
    </div>
  </div>
</template>

<template name="situationItemLabelView">
  {{#if Template.subscriptionsReady}}
  <p>Label</p>
  <label>
    <button class="btn btn-small">{{situationLabel situation}}</button>
  </label>
  {{/if}}
</template>

<template name="situationItemLabelEdit">
  <p>Label</p>
  <div class="human-labeling">
    {{#if (hasLabel situation)}}
    {{#if (isLabelTrue situation)}}
    <label class="checkcontainer">
      <input type="radio" value="true" checked name="{{situation.alias}}">
      <span>Yes</span>
    </label>
    <label class="checkcontainer">
      <input type="radio" value="false" name="{{situation.alias}}">
      <span>No</span>
    </label>
    {{else}}
    <label class="checkcontainer">
      <input type="radio" value="true" name="{{situation.alias}}">
      <span>Yes</span>
    </label>
    <label class="checkcontainer">
      <input type="radio" value="false" checked name="{{situation.alias}}">
      <span>No</span>
    </label>
    {{/if}}
    {{else}}
    <label class="checkcontainer">
      <input type="radio" value="true" name="{{situation.alias}}">
      <span>Yes</span>
    </label>
    <label class="checkcontainer">
      <input type="radio" value="false" name="{{situation.alias}}">
      <span>No</span>
    </label>
    {{/if}}
  </div>
</template>

<template name="situationItemPrediction">
  {{#if Template.subscriptionsReady}}
  <p>Prediction</p>
  <label>
    <button class="btn btn-small">{{situationPrediction situation}}</button>
  </label>
  {{/if}}
</template>

<template name="situationListTest">
  <ul class="list-group">
    <li class="list-group-item">
      {{> situationItemTest}}
    </li>
    <li class="list-group-item">
      {{> situationItemTest}}
    </li>
  </ul>
</template>

<template name="situationItemTest">
  <div style="display: table; table-layout: auto;">
    <div style="display: table-cell; padding-right: 5px;">
      <div class="place-photo-item">
        <img src="https://s3-media3.fl.yelpcdn.com/bphoto/FtsOLmsPSp6H5DqvvEWZLg/o.jpg" width="90" height="90"
          style="border-radius: 4px; vertical-align: middle;" />
      </div>
    </div>
    <div style="display: table-cell;">
      <div class="place-name">
        <h3 style="font-size: 16px; font-weight: 700;">
          <p>1. <a href="#">Garfield Dog Park</a></p>
        </h3>
      </div>
      <div class="place-categories">
        <span><a href="#">Parks</a></span>
        <span><a href="#">Dog Parks</a></span>
      </div>
    </div>
  </div>
</template>


<template name="instructions">
  <div style="background-color: white; padding: 20px;">
      <ol>
          <li>
              <strong>Step 1. Remove Confounding Context Features.</strong>
              <p>When removing features, follow the following format: parks and NOT swimmingpools. Before removing context features, please simulate to understand impact on loss of recall. For example, before including parks and NOT swimmingpools, simulate parks and swimmingpools.</p>
          </li>
          <li>
              <strong>Step 2. Add Context Features.</strong>
              <p>When removing features, follow the following format: parks and playgrounds. Like in Step 1, simulate before adding context features, for example, before adding playgrounds, simulate parks and NOT playgrounds.</p>
          </li>
          <li>
              <strong>Step 3. Combine refined context features with OR and add to concept expression definitions.</strong>
              <p>For example Safe Places to Bike Ride with Kids = [parks and NOT swimmingpools] OR [parks and playgrounds].</p>
          </li>
          <li>
              <strong>Step 4. Click Simulate Again to see how definition is represented with new data.</strong>
              <p>Repeat process until satisfied with definition.</p>
          </li>
      </ol>
  </div>
</template>
<template name="surfaceConfoundingContextFeatures">
  <li class="list-group-item ">
  <div class="surface-confounding-features multiple-category">
    {{#each category in categories}}
      {{#if @index}} <!-- Skip the first category -->
        <form id = "category-form">
          <input type="hidden" name="category" value="{{category.alias}}">
          <label for="yesNoQuestion">It appears that some {{ situation.categoriesKey }} are not {{ conceptVariableHumanReadable }} 
            <br>One possible reason: {{ situation.categoriesKey }} that are for {{ category.alias }}, seems to not work. 
            <br>Consider adding {{ situation.categoriesKey }} AND NOT {{ category.alias }}
            <br>Note: Simulate {{situation.categoriesKey}} AND {{ category.alias }} first.
          </label>
          <div>
            <input type="radio" id="yes" name="yesNoQuestion" value="yes">
            <label for="accept">Accept</label>

            <input type="radio" id="no" name="yesNoQuestion" value="no">
            <label for="edit">Edit</label>
          </div>
          <!-- Submit button -->
          <button type="submit">Submit</button>
        </form>
      {{/if}}
    {{/each}}
  </div>
</li>
</template>

<template name="suggestContextFeatures">
  <li class="list-group-item ">
  <div class="surface-confounding-features multiple-category">
    {{#each category in categories}}
      {{#if @index}} <!-- Skip the first category -->
        <form id = "category-form">
          <input type="hidden" name="category" value="{{category.alias}}">
          <label for="yesNoQuestion">It appears that some {{ situation.categoriesKey }} that are {{ category.alias }} work well.
            <br>Add: {{ situation.categoriesKey }} AND {{ category.alias }}?
            <br>Simulate: {{situation.categoriesKey}} AND NOT {{ category.alias }} before adding.
          </label>
          <div>
            <input type="radio" id="yes" name="yesNoQuestion" value="yes">
            <label for="accept">Accept</label>

            <input type="radio" id="no" name="yesNoQuestion" value="no">
            <label for="edit">Edit</label>
          </div>
          <!-- Submit button -->
          <button type="submit">Submit</button>
        </form>
      {{/if}}
    {{/each}}
  </div>
</li>
</template>



<!-- <template name = "surfaceConfoundingContextFeatures">
  <li class="list-group-item surface-confounding-features multiple-category">
    <form action="/submit" method="post">
      
      Yes or No question
      <label for="yesNoQuestion">It appears that some {{situation.categoriesKey}} are not
        {{conceptVariableName}}.
        One possible reason: {{situation.categoriesKey}} that are for
        <p>[{{#each category in categories}} {{category.alias}}, {{/each}}] </p>  seems to not work.
        Exclude them?
      </label>
      <div>
        <input type="radio" id="yes" name="yesNoQuestion" value="yes">
        <label for="accept">accept</label>

        <input type="radio" id="no" name="yesNoQuestion" value="no">
        <label for="edit">edit</label>
      </div>

      Submit button
      <button type="submit">Submit</button>
    </form>
  </li>
</template> -->




